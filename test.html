<!DOCTYPE html>
<html>
<head>
    <title>test</title>
    <link rel="stylesheet" type="text/css" href="test.css">
    
    <!-- import AngularJS-->
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.4/angular.min.js"></script>
    
    <!-- import EaselJS -->
	<script src="http://code.createjs.com/easeljs-0.8.1.min.js"></script>
    
	<script>
        
		var stage;
        var canvas;
        
        var userContainer;
        var tweetContainer;
        var twtEntityContainer;
        var retweetContainer;
        var geoContainer;
        
        var timeline;
        var friends;
        var followers;
        
        var user;
        var entities;
        var retweet;
        
        var user_mentions;
        var retweeted_status;
        var contained_within;
        
        var currWidth, currHeight;
        
        var txt;
        var mid;
        var media;
        
        var static;
        
        var twtUserColor, tweetColor, twtGeoColor;
        
        var queryUserParameters;
        var count;
        
		function init() {
            
            currWidth = 1200;
            currHeight = 600;
            canvas = document.getElementById("myCanvas");
            
            count = document.getElementById("common");
            
            queryUserParameters = document.getElementById("form");
            
            stage = new createjs.Stage("myCanvas");
            stage.enableMouseOver(10);
            
            twtUserColor = "red";
            tweetColor = "#1e90ff";
            twtGeoColor = "brown";
            
            var rect0 = new createjs.Shape();
            rect0.on("click", handleClickQueryUser);
            var rect1 = new createjs.Shape();
            rect1.on("click", handleClickQueryTweet);
            var rect2 = new createjs.Shape();
            rect2.on("click", handleClickQueryGeo);
            
            static = new createjs.Container();
            
            rects = [rect0, rect1, rect2];
            for(i = 0; i < rects.length; i++){
                rects[i].x = 160 + 150 * i;
                rects[i].y = 20;
                rects[i].graphics.beginFill("blue").drawRect(0, 0, 100, 50);
                rects[i].alpha = 0.4;
                static.addChild(rects[i]);
            }
            
            var label0 = new createjs.Text("queryUser", "20px Arial", "black");
            var label1 = new createjs.Text("queryTweet", "19px Arial", "black");
            var label2 = new createjs.Text("queryGeo", "20px Arial", "black");
            labels = [label0, label1, label2];
            for(i = 0; i < rects.length; i++){
                labels[i].x = rects[i].x;
                labels[i].y = rects[i].y + 10;
                static.addChild(labels[i]);
            }
            
            stage.addChild(static);
            
            txt = new createjs.Text("{\n  twitter{\n  }\n}", "15px Arial", "black");
            txt.x = currWidth - 200;
            mid = "";
            
            media = new createjs.Text("stackExchange\n\nmediaWiki\n\ninstagram\n\npinterest\n\ntwitter\n\nfacebook\n\nflickr\n\nspotify\n\nyoutube\n\nreddit\n\nweibo\n\ntumblr", "15px Arial", "black");
            media.x = 20;
            media.y = 120;
            
			stage.addChild(txt, media);
 
			stage.update();
			createjs.Ticker.addEventListener("tick", stage);
		}
    
    function handleMouseOver(event){
        event.target.alpha = ((event.type=="mouseover") ? 0.75 : 0.5);
    }
    
    function handleClickQueryUser(){
        stage.removeAllChildren();
        stage.addChild(txt, media, static);
        var circle = new createjs.Shape();
        circle.graphics.beginFill(twtUserColor).drawCircle(0, 0, 60);
        circle.x = 250;
        circle.y = 180;
        circle.alpha = 0.5;
        circle.on("mouseover", handleMouseOver);
        circle.on("mouseout", handleMouseOver);
        circle.on("click", drawTwtUserFields);
        
        var label = new createjs.Text("queryUser", "20px Arial", "#000");
        label.x = circle.x - 50;
        label.y = circle.y - 35;
        
        txt.text = "{\n  twitter{\n    queryUser(){\n" + mid + "    }\n  }\n}";
        
        stage.addChild(circle, label);
        
        queryUserParameters.style.display = "inline";
        
        stage.update();
    }
    
    function handleClickQueryTweet(){
        stage.removeAllChildren();
        stage.addChild(txt, media, static);
        queryUserParameters.style.display = "none";
        
        var circle = new createjs.Shape();
        circle.graphics.beginFill(tweetColor).drawCircle(0, 0, 60);
        circle.x = 250;
        circle.y = 180;
        circle.alpha = 0.5;
        circle.on("mouseover", handleMouseOver);
        circle.on("mouseout", handleMouseOver);
        circle.on("click", drawTweetFields);
        
        var label = new createjs.Text("queryTweet", "20px Arial", "#000");
        label.x = circle.x - 50;
        label.y = circle.y - 35;
        
        txt.text = "{\n  twitter{\n    queryTweet(){\n" + mid + "    }\n  }\n}";
        
        stage.addChild(circle, label);
        
        stage.update();
        
    }
    
    function handleClickQueryGeo(){
        stage.removeAllChildren();
        stage.addChild(txt, media, static);
        var circle = new createjs.Shape();
        circle.graphics.beginFill(twtGeoColor).drawCircle(0, 0, 60);
        circle.x = 250;
        circle.y = 180;
        circle.alpha = 0.5;
        circle.on("mouseover", handleMouseOver);
        circle.on("mouseout", handleMouseOver);
        circle.on("click", drawTwtGeoFields);
        
        var label = new createjs.Text("queryGeo", "20px Arial", "#000");
        label.x = circle.x - 50;
        label.y = circle.y - 35;
        
        txt.text = "{\n  twitter{\n    queryGeo(){\n" + mid + "    }\n  }\n}";
        
        stage.addChild(circle, label);
        stage.update();
    }
    
    
    
    function addSmallCircle(x, y, name, container){
        var circle = new createjs.Shape();
        circle.graphics.beginFill("grey").drawCircle(0, 0, 15);
        circle.name = name;
        var label = new createjs.Text(name, "11px Arial", "#000");
        circle.x = label.x = x;
        circle.y = label.y = y;
        circle.alpha = 0.5;
        circle.on("click", changeQuery);
        container.addChild(circle, label);
    }
    
    function changeQuery(event){
        event.target.alpha = 1.5 - event.target.alpha;
        mid += event.target.name + "\n";
        txt.text = "{\n  twitter{\n    queryUser(){\n" + mid + "    }\n  }\n}";
        stage.update();
    }
    
    function addBigCircle(x, y, name, color){
        
        if(x > currWidth){
            resizeWidth();
        }
        if(y > currHeight){
            resizeHeight();
        }
        
        var circle = new createjs.Shape();
        circle.graphics.beginFill(color).drawCircle(0, 0, 60);
        circle.alpha = 0.5;
        circle.on("mouseover", handleMouseOver);
        circle.on("mouseout", handleMouseOver);
        
        var label = new createjs.Text(name, "20px Arial", "#000");
        
        circle.x = label.x = x;
        circle.y = label.y = y;
        switch(name){
            case "timeline":
                circle.on("click", handleClickTimeline);
                timeline = new createjs.Container();
                timeline.addChild(circle, label);
                stage.addChild(timeline);
                break;
            
            case "friends":
                circle.on("click", handleClickFriends);
                friends = new createjs.Container();
                friends.addChild(circle, label);
                stage.addChild(friends);
                break;
                
            case "followers":
                circle.on("click", handleClickFollowers);
                followers = new createjs.Container();
                followers.addChild(circle, label);
                stage.addChild(followers);
                break;
                
            case "user":
                circle.on("click", handleClickUser);
                user = new createjs.Container();
                user.addChild(circle, label);
                stage.addChild(user);
                break;
                
            case "entities":
                circle.on("click", handleClickEntities);
                entities = new createjs.Container();
                entities.addChild(circle, label);
                stage.addChild(entities);
                break;
                
            case "retweet":
                circle.on("click", handleClickRetweet);
                retweet = new createjs.Container();
                retweet.addChild(circle, label);
                stage.addChild(retweet);
                break;
                
            case "user_mentions":
                circle.on("click", handleClickUserMentions);
                user_mentions = new createjs.Container();
                user_mentions.addChild(circle, label);
                stage.addChild(user_mentions);
                break;
                
            case "retweeted_status":
                circle.on("click", handleClickRetweetedStatus);
                retweeted_status = new createjs.Container();
                retweeted_status.addChild(circle, label);
                stage.addChild(retweeted_status);
                break;
                
            case "contained_within":
                circle.on("click", handleClickContainedWithin);
                contained_within = new createjs.Container();
                contained_within.addChild(circle, label);
                stage.addChild(contained_within);
                break;
        }
    }
    
    
    function addArrow(fromx, fromy, tox, toy, container){
        var lineShape = new createjs.Shape();
        lineShape.graphics.setStrokeStyle(1).beginStroke("black").moveTo(fromx, fromy).lineTo(tox, toy);
        container.addChild(lineShape);
        
    }
    
    
    <!-- display all fields of twtUser -->
    
    function drawTwtUserFields(event){
        
        var obj = event.target;
        
        addBigCircle(obj.x + 300, obj.y, "timeline", tweetColor);
        addArrow(obj.x + 50, obj.y, obj.x + 240, obj.y, timeline);
        
        addBigCircle(obj.x + 212, obj.y + 212, "friends", twtUserColor);
        addArrow(obj.x + 35, obj.y + 35, obj.x + 169, obj.y + 169, friends);
        
        addBigCircle(obj.x, obj.y + 300, "followers", "red");
        addArrow(obj.x, obj.y + 50, obj.x, obj.y + 240, followers);
        
        userContainer = new createjs.Container();
        
        addSmallCircle(obj.x, obj.y - 95, "id", userContainer);
        
        addSmallCircle(obj.x + 38, obj.y - 87, "id_str", userContainer);
        
        addSmallCircle(obj.x + 70, obj.y - 64, "name", userContainer);
        
        addSmallCircle(obj.x + 90, obj.y - 29, "screen_name", userContainer);
        
        addSmallCircle(obj.x + 94, obj.y + 10, "description", userContainer);
        
        <!-- pivot -->
        addSmallCircle(obj.x + 82, obj.y + 48, "created_at", userContainer);
        
        addSmallCircle(obj.x + 56, obj.y + 77, "profile_image_url", userContainer);
        
        addSmallCircle(obj.x + 19, obj.y + 93, "url", userContainer);
        
        addSmallCircle(obj.x - 19, obj.y + 93, "location", userContainer);
        
        addSmallCircle(obj.x - 56, obj.y + 77, "tweets_count", userContainer);
        
        <!-- pivot -->
        addSmallCircle(obj.x - 82, obj.y + 48, "followers_count", userContainer);
        
        addSmallCircle(obj.x - 94, obj.y + 10, "listed_count", userContainer);
        
        addSmallCircle(obj.x - 90, obj.y - 29, "favourites_count", userContainer);
        
        addSmallCircle(obj.x - 70, obj.y - 64, "statuses_count", userContainer);
        
        addSmallCircle(obj.x - 38, obj.y - 87, "timezone", userContainer);
      
        stage.addChild(userContainer);
        stage.update();
    }
    
    <!-- display all fields of twtGeo -->
    function drawTwtGeoFields(event){
        var obj = event.target;
        addBigCircle(obj.x + 300, obj.y, "contained_within", twtGeoColor);
        addArrow(obj.x + 50, obj.y, obj.x + 250, obj.y, contained_within);
        
        geoContainer = new createjs.Container();
        addSmallCircle(obj.x, obj.y - 95, "attributes", geoContainer);
        addSmallCircle(obj.x + 67, obj.y - 67, "country", geoContainer);
        addSmallCircle(obj.x + 95, obj.y, "country_code", geoContainer);
        addSmallCircle(obj.x + 67, obj.y + 67, "full_name", geoContainer);
        addSmallCircle(obj.x, obj.y + 95, "id", geoContainer);
        addSmallCircle(obj.x - 67, obj.y + 67, "name", geoContainer);
        addSmallCircle(obj.x - 95, obj.y, "place_type", geoContainer);
        addSmallCircle(obj.x - 67, obj.y - 67, "url", geoContainer);
        stage.addChild(geoContainer);
        stage.update();
        
    }
    
    <!-- called when "timeline" clicked -->
    function handleClickTimeline(event){
        stage.removeChild(userContainer);
        stage.removeChild(friends);
        stage.removeChild(followers);
        stage.update();
        drawTweetFields(event);
    }
    
    <!-- called when "friends" clicked -->
    function handleClickFriends(event){
        stage.removeChild(userContainer);
        stage.removeChild(timeline);
        stage.removeChild(followers);
        stage.update();
        drawTwtUserFields(event);
    }
    
    <!-- called when "followers" clicked -->
    function handleClickFollowers(event){
        stage.removeChild(userContainer);
        stage.removeChild(timeline);
        stage.removeChild(friends);
        stage.update();
        drawTwtUserFields(event);
    }
    
    <!-- called when "user" clicked -->
    function handleClickUser(event){
        stage.removeChild(tweetContainer);
        stage.removeChild(entities);
        stage.removeChild(retweet);
        stage.update();
        drawTwtUserFields(event);
    }
    
    <!-- called when "entities" clicked TODO: need to check parent -->
    function handleClickEntities(event){
        stage.removeChild(tweetContainer);
        stage.removeChild(user);
        stage.removeChild(retweet);
        stage.update();
        drawTwtEntityFields(event);
    }
    
    <!-- called when "retweet" clicked -->
    function handleClickRetweet(event){
        stage.removeChild(tweetContainer);
        stage.removeChild(user);
        stage.removeChild(entities);
        stage.update();
        drawRetweetFields(event);
    }
    
    <!-- called when "user_mentions" clicked -->
    function handleClickUserMentions(event){
        stage.removeChild(twtEntityContainer);
        stage.update();
        drawTwtUserFields(event);

    }
    
    <!-- called when "retweeted_status" clicked -->
    function handleClickRetweetedStatus(event){
        stage.removeChild(retweetContainer);
        stage.removeChild(entities);
        stage.removeChild(user);
        stage.update();
        drawTweetFields(event);
        
    }
    
    function handleClickContainedWithin(event){
        stage.removeChild(geoContainer);
        stage.update();
        drawTwtGeoFields(event);
    }
    
    <!-- display all fields of tweet -->
    
    function drawTweetFields(event){
        
        var obj = event.target;
        
        addBigCircle(obj.x + 300, obj.y, "user", "red");
        addArrow(obj.x + 50, obj.y, obj.x + 250, obj.y, user);
        
        addBigCircle(obj.x + 212, obj.y + 212, "entities", "yellow");
        addArrow(obj.x + 35, obj.y + 35, obj.x + 175, obj.y + 175, entities);
        
        addBigCircle(obj.x, obj.y + 300, "retweet", "green");
        addArrow(obj.x, obj.y + 50, obj.x, obj.y + 250, retweet);

        tweetContainer = new createjs.Container();
        
        addSmallCircle(obj.x, obj.y - 95, "id", tweetContainer);
        
        addSmallCircle(obj.x + 67, obj.y - 67, "id_str", tweetContainer);
        
        addSmallCircle(obj.x + 95, obj.y, "created_at", tweetContainer);
        
        addSmallCircle(obj.x + 67, obj.y + 67, "text", tweetContainer);
        
        addSmallCircle(obj.x, obj.y + 95, "retweet_count", tweetContainer);
        
        addSmallCircle(obj.x - 67, obj.y + 67, "in_reply_to_user_id_str", tweetContainer);
        
        addSmallCircle(obj.x - 95, obj.y, "in_reply_to_status_id_str", tweetContainer);
        
        addSmallCircle(obj.x - 67, obj.y - 67, "in_reply_to_screen_name", tweetContainer);
        
        stage.addChild(tweetContainer);
        stage.update();
    }
    
    
    function drawTwtEntityFields(event){
        var obj = event.target;
        
        addBigCircle(obj.x + 300, obj.y, "user_mentions", "red");
        addArrow(obj.x + 50, obj.y, obj.x + 250, obj.y, user_mentions);
        
        twtEntityContainer = new createjs.Container();
        
        addSmallCircle(obj.x, obj.y - 95, "urls", twtEntityContainer);
        addSmallCircle(obj.x - 95, obj.y, "hashtags", twtEntityContainer);
        
        stage.addChild(twtEntityContainer);
        stage.update();
    }
    
    function drawRetweetFields(event){
        var obj = event.target;
        
        addBigCircle(obj.x + 300, obj.y, "entities", "yellow");
        addArrow(obj.x + 50, obj.y, obj.x + 250, obj.y, entities);
        
        addBigCircle(obj.x + 212, obj.y + 212, "retweeted_status", "#1e90ff");
        addArrow(obj.x + 35, obj.y + 35, obj.x + 175, obj.y + 175, retweeted_status);
        
        addBigCircle(obj.x, obj.y + 300, "user", "red");
        addArrow(obj.x, obj.y + 50, obj.x, obj.y + 250, user);
        
        retweetContainer = new createjs.Container();
        
        addSmallCircle(obj.x, obj.y - 95, "id", retweetContainer);
        
        addSmallCircle(obj.x + 82, obj.y + 48, "created_at", retweetContainer);
        
        addSmallCircle(obj.x - 82, obj.y + 48, "in_reply_to_screen_name", retweetContainer)
        
        stage.addChild(retweetContainer);
        stage.update();

    }
    
    <!-- double the size of canvas width -->
    function resizeWidth(){
        canvas = document.getElementById("myCanvas");
        canvas.width = 2 * canvas.width;
        currWidth = canvas.width;
        alert("width resize to " + currWidth);
    }
    
    <!-- double the size of canvas height -->
    function resizeHeight(){
        canvas = document.getElementById("myCanvas");
        canvas.height = 2 * canvas.height;
        currHeight = canvas.height;
        alert("height resize to " + currHeight);
    }
    
    
	</script>
</head>

<body onload="init();">
    <div class="main">
        <canvas id="myCanvas" width="1200" height="600">
        </canvas>
        <div id='form' style="display:none; position: absolute; z-index:1; left: 240px; top: 180px; width:170px; height:20px;">
            <div ng-app="myApp" ng-controller="myCtrl">
                <p>q: <input ng-model="keyword" type='text' style="width: 50%;" />{{keyword}}</p>
                <div id="common">
                    <p>count: <input type='number' name='Count' min='0' style="width: 30%;" /></p>
                </div>
                <p>page: <input type='number' name='Count' min='0' style="width: 30%;" /></p>
            </div>
        </div>
    </div>
    
    <script>
        var app = angular.module('myApp', []);
        app.controller('myCtrl', function($scope) {
            $scope.keyword = "";
        });
    </script>

</body>
</html>

